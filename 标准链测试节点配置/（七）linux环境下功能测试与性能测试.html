<html>
<head>
  <title>（七）linux环境下功能测试与性能测试</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600667 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="465"/>
<h1>（七）linux环境下功能测试与性能测试</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/4/28 16:02</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><span style="font-weight: bold;">（七）linux环境下功能测试与性能测试</span></div><div><br/></div><div><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">功能测试：</span></div><div><br/></div><div><span style="font-weight: bold;">    a.    cd     /data/canonchain</span></div><div><br/></div><div><span style="font-weight: bold;">    b.    如果需要重新编译    </span><span style="font-weight: bold;">在编译的服务器上（如北京39.106.60.108）    </span><span style="font-weight: bold;">./do_build</span><span style="font-weight: bold;">    </span><span style="font-weight: bold;"> </span></div><div><br/></div><div><span style="font-weight: bold;">    c.    ./do_test</span></div><div><br/></div><div><span style="font-weight: bold;">    d.    测试结束后  </span></div><div><br/></div><div><span style="font-weight: bold;">            如果只需要关闭节点而不需要清除数据：    </span></div><div><span style="font-weight: bold;">        </span></div><div><span style="font-weight: bold;">                    ps -aux|grep canonchain  </span></div><div><br/></div><div><span style="font-weight: bold;">                    kill  ${canonchain_pid}       这里${canonchain_pid}为canonchain的pid号    如果pid = 9898 则 kill 9898即可</span></div><div><br/></div><div><span style="font-weight: bold;">            如果既需要关闭节点又需要清除数据:    ./dropdb_all</span></div><div><br/></div><div><br/></div><div><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">性能测试：</span></div><div><br/></div><div><span style="font-weight: bold;">性能测试工具：</span></div><div><br/></div><div><span style="font-weight: bold;">    a.    gperftools        cpu测试</span></div><div><span style="font-weight: bold;">                    </span></div><div><span style="font-weight: bold;">    b.    jemalloc        heap测试</span></div><div><br/></div><div><span style="font-weight: bold;">    c.    工具文档路径：    </span><span style="font-weight: bold;">C:\Users\Administrator\Desktop\</span><span style="font-weight: bold;">linux性能测试文档</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">性能测试可能的状态组合与对应shell脚本：</span></div><div><br/></div><div><span style="font-weight: bold;">    jemalloc                                    /data/canonchain/</span><span style="color: rgb(227, 0, 0); font-weight: bold;">shell_scripts/jemalloc.sh</span></div><div><br/></div><div><span style="font-weight: bold;">    jemalloc_disable                       /data/canonchain/</span><span style="color: rgb(227, 0, 0); font-weight: bold;">do_rocks_test</span></div><div><br/></div><div><span style="font-weight: bold;">    heap_profile                             /data/canonchain/</span><span style="color: rgb(227, 0, 0); font-weight: bold;">shell_scripts/heaprofile.sh</span></div><div><br/></div><div><span style="font-weight: bold;">    cpu + jemalloc                         /data/canonchain/</span><span style="color: rgb(227, 0, 0); font-weight: bold;">shell_scripts/cpu_jemalloc.sh</span></div><div><br/></div><div><span style="font-weight: bold;">    cpu                                            /data/canonchain/</span><span style="color: rgb(227, 0, 0); font-weight: bold;">shell_scripts/cpu.sh</span></div><div><br/></div><div><span style="font-weight: bold;"><span style="font-weight: bold; color: rgb(227, 0, 0);">    未经测试</span>地址组合的性能测试脚本使用方法<span style="font-weight: bold; color: rgb(227, 0, 0);">：</span></span></div><div><br/></div><div><span style="color: rgb(227, 0, 0); font-weight: bold;">            /data/canonchain/performance.sh --jemalloc --heap_profile</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">性能测试流程：</span></div><div><br/></div><div><span style="color: rgb(227, 0, 0); font-weight: bold;">   </span> <span style="font-weight: bold;">a.    cd     /data/canonchain</span></div><div><br/></div><div><span style="font-weight: bold;">    b.    </span><span style="font-weight: bold;">如果需要重新编译    </span><span style="font-weight: bold;">在编译的服务器上（如北京39.106.60.108）</span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">./do_cmake</span></div><div><br/></div><div><span style="font-weight: bold;">    c.    jemalloc 测试：                      ./</span><span style="font-weight: bold;">shell_scripts/jemalloc.sh</span></div><div><br/></div><div><span style="font-weight: bold;">           jemalloc_disable 测试 ：       ./</span><span style="font-weight: bold;">do_rocks_test</span></div><div><span style="font-weight: bold;">    </span></div><div><span style="font-weight: bold;">           heap_profile 测试 :                ./</span><span style="font-weight: bold;">shell_scripts/heaprofile.sh</span></div><div><span style="font-weight: bold;"> </span></div><div><span style="font-weight: bold;">           cpu + jemalloc 测试 ：          .</span><span style="font-weight: bold;">/</span><span style="font-weight: bold;">shell_scripts/cpu_jemalloc.sh</span></div><div><br/></div><div><span style="font-weight: bold;">            cpu 测试 ：                            .</span><span style="font-weight: bold;">/</span><span style="font-weight: bold;">shell_scripts/cpu.sh</span></div><div><br/></div><div><span style="font-weight: bold;">    d.    测试结束后    </span></div><div><br/></div><div><span style="font-weight: bold;">            </span><span style="font-weight: bold;">如果只需要关闭节点而不需要清除数据：</span><span style="font-weight: bold;">    </span></div><div><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span></div><div><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">ps -aux|grep canonchain  </span></div><div><br/></div><div><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">kill  ${canonchain_pid}</span><span style="font-weight: bold;">     </span><span style="font-weight: bold;">  这里${canonchain_pid}为canonchain的pid号</span><span style="font-weight: bold;">    如果pid = 9898 则 kill 9898即可</span></div><div><br/></div><div><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">    </span><span style="font-weight: bold;">如果既需要关闭节点又需要清除数据:    ./dropdb_all</span></div><div><br/></div><div><span style="font-weight: bold;">    e.    测试结束后    如果需要备份性能测试数据：    ./mv_back</span></div><div><br/></div><div><span style="font-weight: bold;">            <span style="font-weight: bold; color: rgb(227, 0, 0);">清空./cpu_profile和./heap_profile目录下所有的性能测试文件</span></span></div></span>
</div></body></html> 